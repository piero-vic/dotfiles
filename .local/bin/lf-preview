#!/usr/bin/env bash

filepath="${1}"
width="${2}"
mimetype="$(file --dereference --brief --mime-type -- "${filepath}")"

case "$mimetype" in
*application/json*)
  jq --color-output . "$filepath"
  ;;
*application/pdf*)
  pdfinfo "$1"
  ;;
*application/vnd.rar*)
  unrar l "$1"
  ;;
*application/vnd.sqlite3*)
  sqlite3 "$1" ".schema" | bat --color=always --paging=never --style=plain --terminal-width $(($width - 3)) --language=sql
  ;;
*application/x-tar* | *application/x-compressed-tar* | *application/x-*-compressed-tar*)
  tar -tvf "$1"
  ;;
*application/zip* | *application/epub\+zip*)
  unzip -l "$1"
  ;;
*audio/* | *image/* | *video/*)
  mediainfo "$1"
  ;;
*inode/symlink*)
  lf-preview "$(readlink -f "$filepath")" "${@:width}"
  ;;
*text/*)
  bat --color=always --paging=never --style=plain --terminal-width $(($width - 3)) "$filepath"
  ;;
*)
  echo '----- File Type Classification -----' && file --dereference --brief -- "${filepath}"
  ;;
esac
